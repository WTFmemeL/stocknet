
=== StockNet v9 — CNN+WaveNet fusion, anti-leak strict ===
✅ Feature 'vol_price_ratio' calculée (ratio volume/prix).
✅ Feature 'ctx_div_cvd_uptrend' calculée (divergence CVD-prix en tendance haussière).
✅ Feature 'ctx_div_rsi_downtrend' calculée (divergence RSI-prix en tendance baissière).
✅ Feature 'ctx_div_cvd_lowvol' calculée (divergence CVD-volume pondérée).
✅ Feature 'ctx_div_rsi_lowvol' calculée (divergence RSI-volume pondérée).
✅ Données : 392,901 lignes
✅ Colonne cvd_state générée avant feature shifting.
✅ cvd_state encodé numériquement.
⏱️ Split strict: train=294675, test=78580, gap=19645
✅ Fenêtrage: X_train=(2946, 100, 20), X_test=(589, 100, 20)
⚙️ Entraînement StockNetCNN+WaveNet (3-classes)...
Epoch 1/30
 1/93 [..............................] - ETA: 26s - loss: 1.0670 - accuracy: 0.562534/93 [=========>....................] - ETA: 0s - loss: 0.8537 - accuracy: 0.5000 70/93 [=====================>........] - ETA: 0s - loss: 0.8134 - accuracy: 0.490293/93 [==============================] - 1s 3ms/step - loss: 0.8041 - accuracy: 0.4932 - val_loss: 0.8620 - val_accuracy: 0.4739 - lr: 0.0010
Epoch 2/30
 1/93 [..............................] - ETA: 0s - loss: 0.7080 - accuracy: 0.593835/93 [==========>...................] - ETA: 0s - loss: 0.7850 - accuracy: 0.493871/93 [=====================>........] - ETA: 0s - loss: 0.7775 - accuracy: 0.484693/93 [==============================] - 0s 2ms/step - loss: 0.7758 - accuracy: 0.4885 - val_loss: 0.8579 - val_accuracy: 0.4611 - lr: 0.0010
Epoch 3/30
 1/93 [..............................] - ETA: 0s - loss: 0.6881 - accuracy: 0.625037/93 [==========>...................] - ETA: 0s - loss: 0.7800 - accuracy: 0.504274/93 [======================>.......] - ETA: 0s - loss: 0.7740 - accuracy: 0.506893/93 [==============================] - 0s 2ms/step - loss: 0.7738 - accuracy: 0.5092 - val_loss: 0.8537 - val_accuracy: 0.4624 - lr: 0.0010
Epoch 4/30
 1/93 [..............................] - ETA: 0s - loss: 0.7422 - accuracy: 0.593839/93 [===========>..................] - ETA: 0s - loss: 0.7618 - accuracy: 0.524077/93 [=======================>......] - ETA: 0s - loss: 0.7635 - accuracy: 0.517993/93 [==============================] - 0s 2ms/step - loss: 0.7703 - accuracy: 0.5163 - val_loss: 0.8665 - val_accuracy: 0.4764 - lr: 0.0010
Epoch 5/30
 1/93 [..............................] - ETA: 0s - loss: 0.8469 - accuracy: 0.343840/93 [===========>..................] - ETA: 0s - loss: 0.7691 - accuracy: 0.513378/93 [========================>.....] - ETA: 0s - loss: 0.7682 - accuracy: 0.520493/93 [==============================] - 0s 2ms/step - loss: 0.7680 - accuracy: 0.5139 - val_loss: 0.8525 - val_accuracy: 0.4637 - lr: 0.0010
Epoch 6/30
 1/93 [..............................] - ETA: 0s - loss: 0.7293 - accuracy: 0.437539/93 [===========>..................] - ETA: 0s - loss: 0.7625 - accuracy: 0.519277/93 [=======================>......] - ETA: 0s - loss: 0.7636 - accuracy: 0.518393/93 [==============================] - 0s 2ms/step - loss: 0.7629 - accuracy: 0.5180 - val_loss: 0.8541 - val_accuracy: 0.4726 - lr: 0.0010
Epoch 7/30
 1/93 [..............................] - ETA: 0s - loss: 0.7022 - accuracy: 0.656239/93 [===========>..................] - ETA: 0s - loss: 0.7708 - accuracy: 0.527277/93 [=======================>......] - ETA: 0s - loss: 0.7620 - accuracy: 0.526893/93 [==============================] - 0s 2ms/step - loss: 0.7616 - accuracy: 0.5227 - val_loss: 0.8588 - val_accuracy: 0.4497 - lr: 0.0010
Epoch 8/30
 1/93 [..............................] - ETA: 0s - loss: 0.6945 - accuracy: 0.625039/93 [===========>..................] - ETA: 0s - loss: 0.7561 - accuracy: 0.532977/93 [=======================>......] - ETA: 0s - loss: 0.7520 - accuracy: 0.530493/93 [==============================] - 0s 2ms/step - loss: 0.7590 - accuracy: 0.5244 - val_loss: 0.8675 - val_accuracy: 0.4739 - lr: 0.0010
Epoch 9/30
 1/93 [..............................] - ETA: 0s - loss: 0.8896 - accuracy: 0.531238/93 [===========>..................] - ETA: 0s - loss: 0.7393 - accuracy: 0.556775/93 [=======================>......] - ETA: 0s - loss: 0.7465 - accuracy: 0.557193/93 [==============================] - 0s 2ms/step - loss: 0.7509 - accuracy: 0.5533 - val_loss: 0.8551 - val_accuracy: 0.4828 - lr: 5.0000e-04
Epoch 10/30
 1/93 [..............................] - ETA: 0s - loss: 0.8411 - accuracy: 0.531239/93 [===========>..................] - ETA: 0s - loss: 0.7610 - accuracy: 0.535376/93 [=======================>......] - ETA: 0s - loss: 0.7523 - accuracy: 0.555593/93 [==============================] - 0s 2ms/step - loss: 0.7483 - accuracy: 0.5468 - val_loss: 0.8803 - val_accuracy: 0.4675 - lr: 5.0000e-04
 1/25 [>.............................] - ETA: 0s - loss: 1.2985 - accuracy: 0.437525/25 [==============================] - 0s 788us/step - loss: 0.8525 - accuracy: 0.4637

📊 Accuracy=0.464
⚠️ Signal faible ou bruité.
💾 Modèle sauvegardé : model_v9_last.keras

📈 Génération des prédictions et rapport de test...
 1/25 [>.............................] - ETA: 0s25/25 [==============================] - 0s 808us/step
💾 Résultats enregistrés : /home/jx/Documents/stocknet/out/preds_v9.csv

📊 Rapport de classification :
              precision    recall  f1-score   support

           0      0.457     0.696     0.552       365
           1      0.000     0.000     0.000        44
           2      0.480     0.293     0.364       376

    accuracy                          0.464       785
   macro avg      0.312     0.329     0.305       785
weighted avg      0.442     0.464     0.431       785


🧩 Matrice de confusion :
[[254   0 111]
 [ 36   0   8]
 [266   0 110]]
